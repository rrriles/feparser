ZeroClipboard.setMoviePath('ZeroClipboard10.swf');var outputText;var outputTable;var genPreroll='http://cdn.video.abc.com/streaming/ads/abccom/abc_generic_preroll_20071031_500x282_400kbps_f8.flv';var genLogo='http://cdn.video.abc.com/streaming/ads/abccom/abcfep_300x60.jpg';var genLogoClick='http://abc.go.com/';var genPauseAd='http://cdn.video.abc.com/streaming/ads/abccom/house_pause_ad2011.swf';var clipParser=new ZeroClipboard.Client();var clipTable=[];function feParse(){var labelTitle;var genCheck;var inputClass;var inputId;var inputValue;var statusDiv;var colorDiv;var colorA;$('textarea').text("");outputText="";$('table#outputTable').text("");outputTable="";$('tr').each(function(){labelTitle=$(this).children('td').children('label').attr('title');genCheck=$(this).children('td').children('input.checkBox').is(':checked');inputClass=$(this).children('td').children('input:not(.checkBox)').attr('class');inputId=$(this).children('td').children('input:not(.checkBox)').attr('id');inputValue=$(this).children('td').children('input:not(.checkBox)').val();statusDiv=$(this).children('td').children('div.httpStatus').attr('id');colorDiv=$(this).children('td').children('div.colorBox').attr('id');colorA=$(this).children('td').children('div.colorBox').children('a').attr('id');if(inputValue!=$.trim(inputValue)){inputValue=$.trim(inputValue);$('input#'+inputId).val(inputValue);};if(genCheck){if(inputId=='inputPreroll'){inputValue=genPreroll;$('input#'+inputId).val(genPreroll);};if(inputId=='inputLogo'){inputValue=genLogo;$('input#'+inputId).val(genLogo);};if(inputId=='inputLogoClick'){inputValue=genLogoClick;$('input#'+inputId).val(genLogoClick);};if(inputId=='inputPauseAd'){inputValue=genPauseAd;$('input#'+inputId).val(genPauseAd);};};$('a#'+colorA).replaceWith('<a id="'+colorA+'" href="'+inputValue+'" target="new"></a>');if(inputClass=='adPath'){if(inputValue==''||inputValue=='/'){$('input#'+inputId).val('/');$('div#'+statusDiv).text('No Path');$('div#'+colorDiv).css('background-color','#FFFF00');parseUrl('/',labelTitle);}
else if(inputValue.match(/.*vwadpath=.+/)){var unicastUrl=inputValue.substr(inputValue.indexOf('vwadpath=')+9);requestUrl(unicastUrl,statusDiv,colorDiv);parseUrl(inputValue,labelTitle);}
else{requestUrl(inputValue,statusDiv,colorDiv);parseUrl(inputValue,labelTitle);};};if(inputClass=='thirdParty'){if(inputValue==''||inputValue=='/'){$('input#'+inputId).val('/');$('div#'+statusDiv).text('No Path');$('div#'+colorDiv).css('background-color','#FFFF00');encodeChars('/',labelTitle,labelTitle);}
else{requestUrl(inputValue,statusDiv,colorDiv);encodeChars(inputValue,labelTitle,labelTitle);};};})
$('textarea').text(outputText);clipParser.setText(outputText);$('#clipParserDiv').children('div').not('#clipParserButton').remove();clipParser.glue('clipParserButton','clipParserDiv');$('table#outputTable').html(outputTable);$('table#outputTable').children('tbody').children('tr').each(function(i){clipTable[i]=new ZeroClipboard.Client();clipTable[i].setText($(this).children('td.url').text());$(this).children('td').children('div.clipDiv').children('div').not('.clip').remove();clipTable[i].glue($(this).children('td').children('div.clipDiv').children('div.clip').attr('id'),$(this).children('td').children('div.clipDiv').attr('id'));});}
function requestUrl(url,statusDiv,colorDiv){var yqlUrl='http://query.yahooapis.com/v1/public/yql?'+'q=select%20*%20from%20html%20where%20url%3D%22'+encodeURIComponent(url)+'%22&diagnostics=true&format=json&callback=?';$.ajaxSetup({timeout:'2000'});$.getJSON(yqlUrl,function(data){if(data.error!=undefined){$('div#'+statusDiv).text(data.error.description.substr(0,64));$('div#'+colorDiv).css('background-color','#FF0000');}
else if(data.query.diagnostics.url['http-status-code']=='200'||data.query.diagnostics.url['http-status-code']=='301'==data.query.diagnostics.url['http-status-code']=='302'){$('div#'+statusDiv).text('Success!');$('div#'+colorDiv).css('background-color','#00FF00');}
else if(data.query.diagnostics.url.error==undefined){$('div#'+statusDiv).text('Success!');$('div#'+colorDiv).css('background-color','#00FF00');}
else{$('div#'+statusDiv).text(data.query.diagnostics.url.error.substr(0,64));$('div#'+colorDiv).css('background-color','#FF0000');};});}
function parseUrl(url,labelTitle){var urlPath=url.substring(0,url.lastIndexOf('/')+1);var urlFile=url.substring(url.lastIndexOf('/')+1);encodeChars(urlFile,labelTitle+' FILE',labelTitle+'FILE');encodeChars(urlPath,labelTitle+' PATH',labelTitle+'PATH');}
function encodeChars(inputValue,parserName,clipId){var encodedUrl=inputValue;var clipParser=new ZeroClipboard.Client();encodedUrl=encodedUrl.replace(/\&(?![A-Za-z]+;|#[0-9]+;)/g,"&");encodedUrl=encodedUrl.replace(/\|/g,"%7C");encodedUrl=encodedUrl.replace(/\s/g,"%20");encodedUrl=encodedUrl.replace(/ll\.media/,"cdn.video");encodedUrl=encodedUrl.replace(/%timestamp%/g,'%TIME%');encodedUrl=encodedUrl.replace(/\[timestamp\]/g,'%TIME%');encodedUrl=encodedUrl.replace(/%5[Bb]timestamp%5[Dd]/g,'%TIME%');outputText+='*BEGIN '+parserName+'*'+encodedUrl+'*END '+parserName+'* ';encodedUrl=encodedUrl.replace(/\&/g,"&amp;");outputTable+='<tr><td class="name">'+parserName+'</td><td class="url">'+encodedUrl+'</td><td class="clipTd"><div id="clipDiv'+clipId+'" class="clipDiv"><div id="clipButton'+clipId+'" class="clip">Copy</div></div></td></tr>';}